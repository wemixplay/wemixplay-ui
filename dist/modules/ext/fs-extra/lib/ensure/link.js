"use strict";var t=require("../../../../_virtual/index2.js");require("../../../universalify/index.js");var e=require("../../../../_virtual/index.js");require("../fs/index.js");var r=require("../mkdirs/index.js"),s=require("../path-exists/index.js"),i=require("../util/stat.js"),a=require("path");const n=t.__exports.fromPromise,c=a,u=e.__exports,l=r.mkdirs,{pathExists:d}=s.pathExists_1,{areIdentical:o}=i.stat;var x={createLink:n((async function(t,e){let r,s;try{r=await u.lstat(e)}catch{}try{s=await u.lstat(t)}catch(t){throw t.message=t.message.replace("lstat","ensureLink"),t}if(r&&o(s,r))return;const i=c.dirname(e);await d(i)||await l.mkdirs(i),await u.link(t,e)})),createLinkSync:function(t,e){let r;try{r=u.lstatSync(e)}catch{}try{const e=u.lstatSync(t);if(r&&o(e,r))return}catch(t){throw t.message=t.message.replace("lstat","ensureLink"),t}const s=c.dirname(e);return u.existsSync(s)||l.mkdirsSync(s),u.linkSync(t,e)}};exports.link=x;
