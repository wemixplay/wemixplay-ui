"use client";
"use strict";var e=require("../../_virtual/_tslib.js"),l=require("react"),r=require('./../../ext/lodash/orderBy.js'),n=require("../../utils/forReactUtils.js"),t=require("../loadings/Spinner.js"),o=require("../../assets/svgs/ico-sort-down-element.svg.js"),a=require("../../assets/svgs/ico-sort-normal-element.svg.js"),s=require("../../assets/svgs/ico-sort-up-element.svg.js"),i=require("../noData/NoDataIconText.js"),d=require("./Table.module.scss.js"),c=require("./TdColumn.js"),u=require("../error/ErrorBoundary.js");const p=n.makeCxFunc(d),m=e=>{let r=[];return l.Children.forEach(e,(e=>{l.isValidElement(e)&&(e.type===l.Fragment?r=[...r,...m(e.props.children)]:e.type===c?r.push(e):r=[...r,...m(e.props.children)])})),r};var v=n=>{let{className:d="",list:v,children:h,loadingElement:g=l.createElement(t,null),errorFallback:E,noDataMsg:S,hideThead:b,sortUpElement:f=l.createElement(s,null),sortDownElement:j=l.createElement(o,null),sortNormalElement:N=l.createElement(a,null),loading:y}=n;const[C,q]=l.useState(!1),[I,w]=l.useState(null),k=l.useMemo((()=>{const e=(v||[]).length>0?null==v?void 0:v[0]:{};return m(h({item:e,index:0}))}),[h,v]),x=l.useMemo((()=>{const e=null==k?void 0:k.map((e=>{var l,r,n,t,o,a,s,i,d,c,u,p,m,v,h;const g=e;return{className:null!==(r=null===(l=g.props)||void 0===l?void 0:l.className)&&void 0!==r?r:"",label:null!==(t=null===(n=g.props)||void 0===n?void 0:n.label)&&void 0!==t?t:"",fieldId:null===(o=g.props)||void 0===o?void 0:o.fieldId,enableSorting:void 0!==(null===(a=g.props)||void 0===a?void 0:a.sortValue)||!!(null===(s=g.props)||void 0===s?void 0:s.handleClickSort),handleClickSort:null===(i=g.props)||void 0===i?void 0:i.handleClickSort,thColSpan:null===(d=g.props)||void 0===d?void 0:d.thColSpan,thRowSpan:null===(c=g.props)||void 0===c?void 0:c.thRowSpan,rowSpan:null===(u=g.props)||void 0===u?void 0:u.rowSpan,colSpan:null===(p=g.props)||void 0===p?void 0:p.colSpan,size:null===(m=g.props)||void 0===m?void 0:m.size,order:null!==(h=null===(v=g.props)||void 0===v?void 0:v.order)&&void 0!==h?h:""}}));return e?e.filter((e=>void 0!==e.label)).map((e=>(null==I?void 0:I.fieldId)?Object.assign(Object.assign({},e),{order:(null==I?void 0:I.fieldId)===e.fieldId?null==I?void 0:I.order:""}):e)):[]}),[k,I]),O=l.useMemo((()=>{const{fieldId:e,order:n}=null!=I?I:{};if(!n)return v;const t=v.map(((e,r)=>l.Children.map(h({item:e,index:r}),(e=>l.isValidElement(e)?e.type===c?e:l.Children.toArray(e.props.children):[])))).reduce(((l,r)=>{var n,t;const o=r.find((l=>l.props.fieldId===e));return l.push(null!==(t=null===(n=o.props)||void 0===n?void 0:n.sortValue)&&void 0!==t?t:0),l}),[]);return r(v.map(((e,l)=>Object.assign(Object.assign({},e),{sortValue:t[l]}))),["sortValue"],[n])}),[v,I,h]);return l.createElement(u,{fallback:E},l.createElement("div",{className:p("table",d,{"no-data":!!v&&0===v.length,loading:!v||C||y})},l.createElement("table",null,!b&&l.createElement("thead",null,l.createElement("tr",null,x.map(((r,n)=>{var t,o,a;return l.createElement("th",{key:"th-".concat(null!==(t=r.fieldId)&&void 0!==t?t:n),className:p(r.fieldId,r.className,{"enable-sorting":r.enableSorting}),rowSpan:null!==(o=r.thRowSpan)&&void 0!==o?o:r.rowSpan,colSpan:null!==(a=r.thColSpan)&&void 0!==a?a:r.colSpan,style:{width:r.size},onClick:()=>(l=>e.__awaiter(void 0,void 0,void 0,(function*(){let e="desc";const{order:r,index:n,fieldId:t,enableSorting:o,handleClickSort:a}=l;if(!o||C)return;"desc"===r?e="asc":"asc"===r&&(e="");const s={index:n,order:e,fieldId:t};if(w(s),a)try{q(!0),yield a(s)}finally{q(!1)}})))(Object.assign(Object.assign({},r),{index:n}))},l.createElement("div",{className:p("th-block")},r.label,!!r.enableSorting&&l.createElement("span",{className:p("ico-sorting")},"desc"!==r.order&&"asc"!==r.order&&N,"desc"===r.order&&j,"asc"===r.order&&f)))})))),l.createElement("tbody",null,(!v||C||y)&&l.createElement("tr",{className:p("loading-tr")},l.createElement("td",{colSpan:x.length},l.createElement("div",{className:p("table-loading")},g))),!!v&&!y&&!C&&(v.length>0?O.map(((e,l)=>h({item:e,index:l}))):l.createElement("tr",{className:p("no-data-tr")},l.createElement("td",{colSpan:x.length},"object"==typeof S?S:l.createElement(i,{className:p("table-no-data"),nullText:S}))))))))};module.exports=v;
