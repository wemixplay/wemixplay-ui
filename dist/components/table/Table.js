"use strict";var e=require("@babel/runtime/helpers/typeof"),r=require("@babel/runtime/helpers/slicedToArray"),n=require("@babel/runtime/helpers/toConsumableArray"),l=require("@babel/runtime/regenerator"),t=require("../../_virtual/_tslib.js"),o=require("react"),a=require("lodash-es"),i=require("../../utils/forReactUtils.js"),s=require("../loadings/Spinner.js"),d=require("../../assets/svgs/ico-sort-down-element.svg.js"),u=require("../../assets/svgs/ico-sort-normal-element.svg.js"),c=require("../../assets/svgs/ico-sort-up-element.svg.js"),p=require("../noData/NoDataIconText.js"),v=require("./Table.module.scss.js"),m=require("./TdColumn.js"),f=require("../error/ErrorBoundary.js"),b=i.makeCxFunc(v),h=function(e){var r=[];return o.Children.forEach(e,(function(e){o.isValidElement(e)&&(e.type===o.Fragment?r=[].concat(n(r),n(h(e.props.children))):e.type===m?r.push(e):r=[].concat(n(r),n(h(e.props.children))))})),r};module.exports=function(n){var i=n.className,v=void 0===i?"":i,g=n.list,E=n.children,S=n.loadingElement,j=void 0===S?o.createElement(s,null):S,q=n.errorFallback,x=n.noDataMsg,C=n.hideThead,N=n.sortUpElement,k=void 0===N?o.createElement(c,null):N,w=n.sortDownElement,y=void 0===w?o.createElement(d,null):w,I=n.sortNormalElement,O=void 0===I?o.createElement(u,null):I,T=n.loading,V=o.useState(!1),D=r(V,2),M=D[0],R=D[1],_=o.useState(null),z=r(_,2),A=z[0],F=z[1],B=o.useMemo((function(){var e=(g||[]).length>0?null==g?void 0:g[0]:{};return h(E({item:e,index:0}))}),[E,g]),U=o.useMemo((function(){var e=null==B?void 0:B.map((function(e){var r,n,l,t,o,a,i,s,d,u,c,p,v,m,f,b=e;return{className:null!==(n=null===(r=b.props)||void 0===r?void 0:r.className)&&void 0!==n?n:"",label:null!==(t=null===(l=b.props)||void 0===l?void 0:l.label)&&void 0!==t?t:"",fieldId:null===(o=b.props)||void 0===o?void 0:o.fieldId,enableSorting:void 0!==(null===(a=b.props)||void 0===a?void 0:a.sortValue)||!!(null===(i=b.props)||void 0===i?void 0:i.handleClickSort),handleClickSort:null===(s=b.props)||void 0===s?void 0:s.handleClickSort,thColSpan:null===(d=b.props)||void 0===d?void 0:d.thColSpan,thRowSpan:null===(u=b.props)||void 0===u?void 0:u.thRowSpan,rowSpan:null===(c=b.props)||void 0===c?void 0:c.rowSpan,colSpan:null===(p=b.props)||void 0===p?void 0:p.colSpan,size:null===(v=b.props)||void 0===v?void 0:v.size,order:null!==(f=null===(m=b.props)||void 0===m?void 0:m.order)&&void 0!==f?f:""}}));return e?e.filter((function(e){return void 0!==e.label})).map((function(e){return(null==A?void 0:A.fieldId)?Object.assign(Object.assign({},e),{order:(null==A?void 0:A.fieldId)===e.fieldId?null==A?void 0:A.order:""}):e})):[]}),[B,A]),G=o.useMemo((function(){var e=null!=A?A:{},r=e.fieldId,n=e.order;if(!n)return g;var l=g.map((function(e,r){return o.Children.map(E({item:e,index:r}),(function(e){return o.isValidElement(e)?e.type===m?e:o.Children.toArray(e.props.children):[]}))})).reduce((function(e,n){var l,t,o=n.find((function(e){return e.props.fieldId===r}));return e.push(null!==(t=null===(l=o.props)||void 0===l?void 0:l.sortValue)&&void 0!==t?t:0),e}),[]);return a.orderBy(g.map((function(e,r){return Object.assign(Object.assign({},e),{sortValue:l[r]})})),["sortValue"],[n])}),[g,A,E]);return o.createElement(f,{fallback:q},o.createElement("div",{className:b("table",v,{"no-data":!!g&&0===g.length,loading:!g||M||T})},o.createElement("table",null,!C&&o.createElement("thead",null,o.createElement("tr",null,U.map((function(e,r){var n,a,i;return o.createElement("th",{key:"th-".concat(null!==(n=e.fieldId)&&void 0!==n?n:r),className:b(e.fieldId,e.className,{"enable-sorting":e.enableSorting}),rowSpan:null!==(a=e.thRowSpan)&&void 0!==a?a:e.rowSpan,colSpan:null!==(i=e.thColSpan)&&void 0!==i?i:e.colSpan,style:{width:e.size},onClick:function(){return function(e){return t.__awaiter(void 0,void 0,void 0,l.mark((function r(){var n,t,o,a,i,s,d;return l.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n="desc",t=e.order,o=e.index,a=e.fieldId,i=e.enableSorting,s=e.handleClickSort,i&&!M){r.next=4;break}return r.abrupt("return");case 4:if("desc"===t?n="asc":"asc"===t&&(n=""),F(d={index:o,order:n,fieldId:a}),!s){r.next=15;break}return r.prev=8,R(!0),r.next=12,s(d);case 12:return r.prev=12,R(!1),r.finish(12);case 15:case"end":return r.stop()}}),r,null,[[8,,12,15]])})))}(Object.assign(Object.assign({},e),{index:r}))}},o.createElement("div",{className:b("th-block")},e.label,!!e.enableSorting&&o.createElement("span",{className:b("ico-sorting")},"desc"!==e.order&&"asc"!==e.order&&O,"desc"===e.order&&y,"asc"===e.order&&k)))})))),o.createElement("tbody",null,(!g||M||T)&&o.createElement("tr",{className:b("loading-tr")},o.createElement("td",{colSpan:U.length},o.createElement("div",{className:b("table-loading")},j))),!!g&&!T&&!M&&(g.length>0?G.map((function(e,r){return E({item:e,index:r})})):o.createElement("tr",{className:b("no-data-tr")},o.createElement("td",{colSpan:U.length},"object"===e(x)?x:o.createElement(p,{className:b("table-no-data"),nullText:x}))))))))};
