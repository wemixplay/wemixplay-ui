"use client";
"use strict";var t=require("../../_virtual/_tslib.js"),e=require('./../../ext/lodash/debounce.js'),r=require('./../../ext/lodash/throttle.js'),o=require("react"),n=require("react-device-detect"),i=require("../../hooks/useClickOutside.js"),l=require("../../utils/forReactUtils.js"),c=require("../portal/Portal.js"),a=require("./Tooltip.module.scss.js"),s=require("../../assets/svgs/ico-tooltip-arrow.svg.js");const u=l.makeCxFunc(a);var d=l=>{let{className:a="",anchorId:d,width:p=200,space:h=4,place:f="bottom",events:g=["hover"],arrowPosition:w=0,hideArrow:m,tooltipPosition:v,tooltipColor:b,tooltipTextColor:x,tooltipBoxShadow:H,tooltipBorderRadius:W,open:E,whenWindowScrollClose:k,children:y}=l;const C=o.useRef(),L=o.useRef(),q=o.useRef(),N=o.useRef(),R=o.useRef(0),Y=o.useRef(!1),[X,j]=o.useState(!1),[T,S]=o.useState(f),[_,A]=o.useState(!!E),B=o.useMemo((()=>{const t=[...g],e=t.findIndex((t=>"hover"===t));return-1===e||n.isMobile||t.splice(e,0,"mouseover","mouseout"),t}),[g]),P=o.useCallback((()=>{if(L.current)return L.current;const t=document.querySelector("#".concat(d));t&&(L.current=t)}),[d]),z=o.useCallback(((t,e)=>{var r;const{scrollY:o,innerHeight:n}=window,i=o,l=o+n,{top:c}=null===(r=L.current)||void 0===r?void 0:r.getBoundingClientRect();return i>t&&c>0?t+c:l<t+e?l-e-10:t}),[]),M=o.useCallback(((t,e)=>{const{scrollX:r,innerWidth:o}=window,n=r+o;return r>t?r+h:n<t+e?n-e-h:t}),[h]),D=o.useCallback((t=>{const{targetTop:e,targetLeft:r,targetWidth:o,targetHeight:n,tooltipHeight:i,arrowWidth:l,arrowHeight:c}=t;return scrollY+e-i-c-h<scrollY&&"top"===f?"bottom":scrollY+e+n+c+h>scrollY+innerHeight&&"bottom"===f?"top":r-l-h<100&&"left"===f?"right":innerWidth-(scrollX+r+o+l+h+10)<100&&"right"===f?"left":r+scrollX<scrollX?"right":f}),[f,h]),I=o.useCallback((()=>{var t;if(!C.current||!L.current)return{targetTop:0,targetLeft:0,targetWidth:0,targetHeight:0,arrowWidth:0,arrowHeight:0,tooltipWidth:0,tooltipHeight:0,scrollX:0,scrollY:0,innerWidth:0,innerHeight:0};const{top:e,left:r,height:o,width:n}=L.current.getBoundingClientRect(),{offsetHeight:i,offsetWidth:l}=C.current,{clientWidth:c=0,clientHeight:a=0}=null!==(t=q.current)&&void 0!==t?t:{},{scrollX:s,scrollY:u,innerWidth:d,innerHeight:p}=window,{position:h,top:f,left:g}=document.body.style,w="fixed"===h?-1*Number(f.replace("px","")):0,m="fixed"===h?-1*Number(g.replace("px","")):0;return{targetTop:e,targetLeft:r,targetWidth:n,targetHeight:o,arrowWidth:c,arrowHeight:a,tooltipWidth:l,tooltipHeight:i,scrollX:m||s,scrollY:w||u,innerWidth:d,innerHeight:p}}),[]),F=o.useCallback((()=>t.__awaiter(void 0,void 0,void 0,(function*(){if(!L.current||!C.current)return;const{targetTop:t,targetLeft:e,targetWidth:r,targetHeight:o,arrowWidth:n,arrowHeight:i,tooltipWidth:l,tooltipHeight:c,scrollX:a,scrollY:s,innerWidth:u,innerHeight:d}=I(),{top:p=0,left:f=0}=null!=v?v:{},g=w||0,m=D({targetTop:t,targetLeft:e,targetWidth:r,targetHeight:o,arrowWidth:n,arrowHeight:i,tooltipWidth:l,tooltipHeight:c,scrollX:a,scrollY:s,innerWidth:u,innerHeight:d});S(m);let b="",x="",H="";switch(m){case"top":b+="\n          top: ".concat(p+s+t-c-i-h,"px;\n          left: ").concat(M(f+a+e+r/2-l/2,l),"px;\n        "),x+="\n          top: ".concat(p+s+t-i-h,"px;\n          left: ").concat(g+a+e+r/2-n/2,"px;\n        ");break;case"left":b+="\n          top: ".concat(z(p+s+t-(c-o)/2,c),"px;\n          left: ").concat(M(f+a+e-l-i-h,l),"px;\n          max-width: ").concat(e-n-h,"px;\n        "),x+="\n          top: ".concat(g+s+t+o/2-n/2,"px;\n          left: ").concat(f+a+e-n-h,"px;\n        ");break;case"right":b+="\n          top: ".concat(z(p+s+t-(c-o)/2,c),"px;\n          left: ").concat(f+a+e+r+n+h,"px;\n          max-width: ").concat(u-(a+e+r+n+h+10),"px;\n        "),x+="\n          top: ".concat(g+s+t+o/2-i/2,"px;\n          left: ").concat(f+a+e+r+h,"px;\n        ");break;default:b+="\n        top: ".concat(p+s+t+o+i+h,"px;\n        left: ").concat(M(f+a+e+r/2-l/2,l),"px;\n      "),x+="\n        transform: rotate(0deg);\n        top: ".concat(p+s+t+o+h,"px;\n        left: ").concat(g+a+e+r/2-n/2,"px;\n      ")}if(H+="\n      ".concat(b,"\n      width: ").concat(l,"px;\n      height: ").concat(c,"px;\n    "),C.current.setAttribute("style",b),N.current.setAttribute("style",H),q.current&&q.current.setAttribute("style",x),2===R.current)return R.current=0,A(!0);var W;yield(W=20,new Promise((t=>setTimeout(t,W)))),R.current+=1,F()}))),[w,h,v,D,M,z,I]),O=o.useMemo((()=>e.default((t=>{"click"!==t.type&&Y.current||("click"===t.type&&(t.preventDefault(),Y.current=!0),"mouseout"===t.type?A(!1):0===R.current&&F(),t.preventDefault())}),100)),[F]),U=o.useCallback((()=>{L.current&&"boolean"!=typeof E&&B.forEach((t=>{L.current.addEventListener(t,O)}))}),[E,B,O]),G=o.useCallback((()=>{L.current&&B.forEach((t=>{L.current.removeEventListener(t,O)}))}),[B,O]);return i(C,(t=>{if("boolean"==typeof E)return;const e=L.current;e&&!e.contains(t.target)&&(Y.current=!1,A(!1))})),o.useEffect((()=>(P(),U(),()=>{G()})),[F,P,U,G]),o.useEffect((()=>{const t=r((()=>{A(!1)}),30);return window.removeEventListener("resize",t),window.addEventListener("resize",t),k&&(window.removeEventListener("scroll",t),window.addEventListener("scroll",t)),()=>{window.removeEventListener("resize",t),window.removeEventListener("scroll",t)}}),[k,F]),o.useEffect((()=>{E&&X&&F(),A(E)}),[X,E,F]),o.createElement(c,{id:"tooltip"},o.createElement("div",{ref:()=>{X||j(!0)},className:u("tooltip",a,T,{open:_}),style:{visibility:_?"visible":"hidden","--tooltip-color":b,"--tooltip-text-color":x,"--tooltip-box-shadow":H,"--tooltip-border-radius":W}},o.createElement("div",{ref:N,className:u("tooltip-shadow")}),!m&&o.createElement("div",{ref:q,className:u("tooltip-arrow")},o.createElement("span",null,o.createElement(s,{className:u("tooltip-arrow-icon")}))),o.createElement("div",{ref:C,className:u("tooltip-text")},o.createElement("div",{className:u("speech-bubble-wrap")},o.createElement("div",{className:u("speech-bubble"),style:{width:p}},o.createElement("div",null,y))))))};module.exports=d;
