"use strict";var e=require("react"),t=require("../../../hooks/useCheckDevice.js"),s=require("../../../utils/browserUtils.js"),o=require("../../../utils/forReactUtils.js"),l=require("../../drawer/Drawer.js"),r=require("../../../assets/svgs/ico-close-black.svg.js"),c=require("../../../assets/svgs/ico-search-black.svg.js"),n=require("./SelectDropBox.module.scss.js");const a=o.makeCxFunc(n),i=e.forwardRef(((o,n)=>{const{className:i,children:u,label:d,inputEl:m,parentEl:p,maxHeight:b=200,search:w,searchText:h="",searchPlaceholder:v,noDataMsg:f,direction:E="bottom",showCloseBtn:y,whenScrollCloseDropBox:x,setOpen:k,handleSearchTextChange:g,handleKeyPress:C}=o,N=e.useRef(null),q=e.useRef(null),{isDesktop:D,isMobile:L}=t(),[S,j]=e.useState(!1),[T,B]=e.useState(E),H=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",H+"px");const R=e.useMemo((()=>0===e.Children.map(u,(e=>e)).length),[u]),M=e.useMemo((()=>!!L&&(d||y)),[L,d,y]),z=e.useCallback(((e,t)=>{const s=window.scrollY,o=window.scrollY+window.innerHeight;"top"===E&&e-t+10<s?B("bottom"):"bottom"===E&&e+b+10>o&&B("top")}),[E,b]),Y=e.useCallback((e=>{var t;if(!e)return;const{clientWidth:s,clientHeight:o}=e,l=e.getBoundingClientRect(),r="fixed"===document.body.style.position&&!!document.body.style.top&&Number(document.body.style.top.replace("px",""))<0?-1*Number(document.body.style.top.replace("px","")):window.scrollY,c=l.top+r,{left:n}=l;let a="min-width:".concat(s,"px;");const i=null!==(t=N.current.clientHeight)&&void 0!==t?t:0;switch(z(l.top+window.scrollY,i),T){case"top":a+="top: ".concat(c-i-10,"px; left: ").concat(n,"px;");break;case"bottom":a+="top: ".concat(c+o+10,"px; left: ").concat(n,"px;")}return a}),[z,T]),F=e.useCallback((e=>{const{value:t}=e.target;g(t)}),[g]),I=e.useCallback((()=>{g("")}),[g]),P=e.useCallback((()=>{m&&m.blur(),k(!1)}),[m,k]);return e.useEffect((()=>{var e;const t=N.current,s=q.current,o=Y(p);if(t&&s){const l=s.querySelector(".active");"function"==typeof s.scrollTo&&s.scrollTo(0,null!==(e=null==l?void 0:l.offsetTop)&&void 0!==e?e:0),t.setAttribute("style",o)}}),[Y,p]),e.useEffect((()=>{if(q){const e=q.current,t=e.querySelector(".match");t&&([...e.children].map((e=>e.classList.remove("match"))),t.classList.add("match"),e.scrollTo(0,t.offsetTop))}}),[h,q]),e.useEffect((()=>{const e=()=>{window.innerWidth<800||(k(!1),m&&m.blur())};return window.removeEventListener("resize",e),window.addEventListener("resize",e),x&&(window.removeEventListener("scroll",e),window.addEventListener("scroll",e)),()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}}),[m,k,x]),e.useEffect((()=>(L&&s.scrollFreeze(),()=>{L&&s.scrollRelease()})),[L]),e.useImperativeHandle(n,(()=>N.current)),e.createElement("div",{ref:N,role:"button",tabIndex:-1,className:a(i,T,"select-drop-box",L?"":"desktop")},e.createElement("div",{className:a("dim"),onClick:P}),e.createElement(l,{className:a("contents"),direction:"top",disabled:D,onClose:()=>P()},e.createElement("div",null,M&&e.createElement("div",{className:a("hd")},d&&e.createElement("label",{className:a("label")},d),y&&e.createElement("button",{type:"button",className:a("btn-close"),onClick:P},e.createElement(r,null))),w&&e.createElement("div",{className:a("search-area")},e.createElement(c,{className:a("ico-search")}),e.createElement("input",{type:"search",placeholder:v,value:h,onInput:F,onKeyDown:C,onFocus:()=>j(!0),onBlur:()=>j(!1)}),e.createElement("button",{type:"button",style:{display:S&&h?"block":"none"},onMouseDown:I},e.createElement(r,{className:a("ico-reset")}))),e.createElement("div",{ref:q,className:a("scroll-area")},R?f:u))))}));i.displayName="SelectDropBox";var u=i;module.exports=u;
