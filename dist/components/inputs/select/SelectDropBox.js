"use strict";var e=require("@babel/runtime/helpers/toConsumableArray"),t=require("@babel/runtime/helpers/slicedToArray"),n=require("react"),r=require("../../../hooks/useCheckDevice.js"),o=require("../../../utils/browserUtils.js"),l=require("../../../utils/forReactUtils.js"),s=require("../../drawer/Drawer.js"),c=require("../../../assets/svgs/ico-close-black.svg.js"),a=require("../../../assets/svgs/ico-search-black.svg.js"),i=require("./SelectDropBox.module.scss.js"),u=l.makeCxFunc(i),d=n.forwardRef((function(l,i){var d=l.className,m=l.children,f=l.label,p=l.inputEl,v=l.parentEl,b=l.maxHeight,h=void 0===b?200:b,w=l.search,E=l.searchText,y=void 0===E?"":E,x=l.searchPlaceholder,k=l.noDataMsg,C=l.direction,g=void 0===C?"bottom":C,N=l.showCloseBtn,q=l.whenScrollCloseDropBox,D=l.setOpen,L=l.handleSearchTextChange,S=l.handleKeyPress,T=n.useRef(null),j=n.useRef(null),B=r(),H=B.isDesktop,R=B.isMobile,M=n.useState(!1),z=t(M,2),Y=z[0],A=z[1],F=n.useState(g),I=t(F,2),P=I[0],K=I[1],U=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",U+"px");var W=n.useMemo((function(){return 0===n.Children.map(m,(function(e){return e})).length}),[m]),O=n.useMemo((function(){return!!R&&(f||N)}),[R,f,N]),G=n.useCallback((function(e,t){var n=window.scrollY,r=window.scrollY+window.innerHeight;"top"===g&&e-t+10<n?K("bottom"):"bottom"===g&&e+h+10>r&&K("top")}),[g,h]),J=n.useCallback((function(e){var t;if(e){var n=e.clientWidth,r=e.clientHeight,o=e.getBoundingClientRect(),l="fixed"===document.body.style.position&&!!document.body.style.top&&Number(document.body.style.top.replace("px",""))<0?-1*Number(document.body.style.top.replace("px","")):window.scrollY,s=o.top+l,c=o.left,a="min-width:".concat(n,"px;"),i=null!==(t=T.current.clientHeight)&&void 0!==t?t:0;switch(G(o.top+window.scrollY,i),P){case"top":a+="top: ".concat(s-i-10,"px; left: ").concat(c,"px;");break;case"bottom":a+="top: ".concat(s+r+10,"px; left: ").concat(c,"px;")}return a}}),[G,P]),Q=n.useCallback((function(e){var t=e.target.value;L(t)}),[L]),V=n.useCallback((function(){L("")}),[L]),X=n.useCallback((function(){p&&p.blur(),D(!1)}),[p,D]);return n.useEffect((function(){var e,t=T.current,n=j.current,r=J(v);if(t&&n){var o=n.querySelector(".active");"function"==typeof n.scrollTo&&n.scrollTo(0,null!==(e=null==o?void 0:o.offsetTop)&&void 0!==e?e:0),t.setAttribute("style",r)}}),[J,v]),n.useEffect((function(){if(j){var t=j.current,n=t.querySelector(".match");n&&(e(t.children).map((function(e){return e.classList.remove("match")})),n.classList.add("match"),t.scrollTo(0,n.offsetTop))}}),[y,j]),n.useEffect((function(){var e=function(){window.innerWidth<800||(D(!1),p&&p.blur())};return window.removeEventListener("resize",e),window.addEventListener("resize",e),q&&(window.removeEventListener("scroll",e),window.addEventListener("scroll",e)),function(){window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}}),[p,D,q]),n.useEffect((function(){return R&&o.scrollFreeze(),function(){R&&o.scrollRelease()}}),[R]),n.useImperativeHandle(i,(function(){return T.current})),n.createElement("div",{ref:T,role:"button",tabIndex:-1,className:u(d,P,"select-drop-box",R?"":"desktop")},n.createElement("div",{className:u("dim"),onClick:X}),n.createElement(s,{className:u("contents"),direction:"top",disabled:H,onClose:function(){return X()}},n.createElement("div",null,O&&n.createElement("div",{className:u("hd")},f&&n.createElement("label",{className:u("label")},f),N&&n.createElement("button",{type:"button",className:u("btn-close"),onClick:X},n.createElement(c,null))),w&&n.createElement("div",{className:u("search-area")},n.createElement(a,{className:u("ico-search")}),n.createElement("input",{type:"search",placeholder:x,value:y,onInput:Q,onKeyDown:S,onFocus:function(){return A(!0)},onBlur:function(){return A(!1)}}),n.createElement("button",{type:"button",style:{display:Y&&y?"block":"none"},onMouseDown:V},n.createElement(c,{className:u("ico-reset")}))),n.createElement("div",{ref:j,className:u("scroll-area")},W?k:m))))}));d.displayName="SelectDropBox",module.exports=d;
