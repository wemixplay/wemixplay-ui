"use strict";var e=require("@babel/runtime/helpers/toConsumableArray"),t=require("@babel/runtime/helpers/slicedToArray"),r=require("react"),n=require("../../../utils/forReactUtils.js"),a=require("../../../utils/valueParserUtils.js"),u=require("./MultiRangeInput.module.scss.js"),l=n.makeCxFunc(u),c=r.forwardRef((function(n,u){var c=n.className,i=void 0===c?"":c,o=n.value,s=n.name,m=n.min,d=n.max,f=n.step,h=void 0===f?1:f,v=n.thumbSize,p=void 0===v?26:v,b=n.sliderHeight,g=void 0===b?6:b,E=n.thumbBorderColor,x=n.thumbColor,y=n.trackColor,C=n.rangeColor,N=n.showTextInput,M=void 0===N||N,k=n.handleChange,R=n.onChange,q=r.useRef([m,d]),w=r.useRef(null),I=r.useRef(null),T=r.useRef(null),V=r.useRef(null),W=r.useState([m,d]),S=t(W,2),U=S[0],j=S[1],B=r.useMemo((function(){return U.map((function(e){return(e-m)/(d-m)*100}))}),[U,m,d]),F=r.useCallback((function(){T.current&&V.current&&(T.current.value=a.commaWithValue(U[0]),V.current.value=a.commaWithValue(U[1]),T.current.style.width="".concat(T.current.scrollWidth,"px"),V.current.style.width="".concat(V.current.scrollWidth,"px"))}),[U]),z=r.useCallback((function(e){"Enter"!==e.key||e.nativeEvent.isComposing||(T.current.blur(),V.current.blur())}),[]),A=r.useCallback((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!M||T.current&&V.current){var n=t.target.value;if("left"===e){var u=Math.min(a.commaStrToNumber(n),U[1]-h);j([u=u>m?u:m,U[1]]),r&&k&&k([u,U[1]],s),T.current.value=a.commaWithValue(u)}else{var l=Math.max(a.commaStrToNumber(n),U[0]+h);l=l<=d?l:d,j([U[0],l]),r&&k&&k([U[0],l],s),V.current.value=a.commaWithValue(l)}R&&R(t),F()}}),[R,M,F,k,s,U,h,m,d]),D=r.useCallback((function(){U.some((function(e,t){return e!==q.current[t]}))&&(q.current=e(U),k&&k(U,s))}),[U,s,k]);return r.useEffect((function(){F()}),[F]),r.useEffect((function(){void 0!==o&&(j(o),q.current=e(o))}),[o]),r.useImperativeHandle(u,(function(){return{focus:w.current.focus}})),r.createElement("div",{className:l("range-input",i,{disabled:m===d}),style:{"--mri-thumb-size":"".concat(p,"px"),"--mri-slider-height":"".concat(g,"px"),"--mri-thumb-border-color":E,"--mri-thumb-color":x,"--mri-track-color":y,"--mri-range-color":C}},r.createElement("div",{className:l("range-area")},r.createElement("div",null,r.createElement("input",{ref:w,type:"range",value:U[0],min:m,max:d,step:h,onChange:function(e){return A("left",e)},onMouseUp:D,onMouseLeave:D,onTouchEnd:D}),r.createElement("input",{ref:I,type:"range",value:U[1],id:"input-right",min:m,max:d,step:h,onChange:function(e){return A("right",e)},onMouseUp:D,onMouseLeave:D,onTouchEnd:D}),r.createElement("div",{className:l("slider")},r.createElement("div",{className:l("track")}),r.createElement("div",{className:l("range"),style:{left:"".concat(B[0],"%"),right:"".concat(100-B[1],"%")}}),r.createElement("div",{className:l("thumb","left"),style:{left:"".concat(B[0],"%")}}),r.createElement("div",{className:l("thumb","right"),style:{right:"".concat(100-B[1],"%")}})))),M&&r.createElement("div",{className:l("range-input")},r.createElement("div",{className:l("input-box")},r.createElement("label",{htmlFor:"rangeMinInput"},"min"),r.createElement("input",{ref:T,type:"text",inputMode:"numeric",defaultValue:U[0],disabled:m===d,onBlur:function(e){return A("left",e,!0)},onKeyDown:z})),r.createElement("div",{className:l("input-box")},r.createElement("label",{htmlFor:"rangeMaxInput"},"max"),r.createElement("input",{ref:V,type:"text",inputMode:"numeric",defaultValue:U[1],disabled:m===d,onBlur:function(e){return A("right",e,!0)},onKeyDown:z}))))}));c.displayName="MultiRangeInput";var i=c;module.exports=i;
