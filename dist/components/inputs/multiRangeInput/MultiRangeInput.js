"use strict";var e=require("@babel/runtime/helpers/toConsumableArray"),t=require("@babel/runtime/helpers/slicedToArray"),n=require("react"),r=require("../../../utils/forReactUtils.js"),a=require("../../../utils/valueParserUtils.js"),u=require("./MultiRangeInput.module.scss.js"),l=r.makeCxFunc(u),c=n.forwardRef((function(r,u){var c=r.className,i=void 0===c?"":c,s=r.value,o=r.name,m=r.min,d=r.max,f=r.step,v=void 0===f?1:f,h=r.thumbSize,p=void 0===h?26:h,g=r.sliderHeight,b=void 0===g?6:g,E=r.handleChange,x=r.onChange,y=n.useRef([m,d]),N=n.useRef(null),M=n.useRef(null),C=n.useRef(null),R=n.useRef(null),k=n.useState([m,d]),q=t(k,2),W=q[0],w=q[1],I=n.useMemo((function(){return W.map((function(e){return(e-m)/(d-m)*100}))}),[W,m,d]),T=n.useCallback((function(){C.current&&R.current&&(C.current.value=a.commaWithValue(W[0]),R.current.value=a.commaWithValue(W[1]),C.current.style.width="".concat(C.current.scrollWidth,"px"),R.current.style.width="".concat(R.current.scrollWidth,"px"))}),[W]),S=n.useCallback((function(e){"Enter"!==e.key||e.nativeEvent.isComposing||(C.current.blur(),R.current.blur())}),[]),U=n.useCallback((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(C.current&&R.current){var r=t.target.value;if("left"===e){var u=Math.min(a.commaStrToNumber(r),W[1]-v);w([u=u>m?u:m,W[1]]),n&&E&&E([u,W[1]],o),C.current.value=a.commaWithValue(u)}else{var l=Math.max(a.commaStrToNumber(r),W[0]+v);l=l<=d?l:d,w([W[0],l]),n&&E&&E([W[0],l],o),R.current.value=a.commaWithValue(l)}x&&x(t),T()}}),[x,T,E,o,W,v,m,d]),V=n.useCallback((function(){W.some((function(e,t){return e!==y.current[t]}))&&(y.current=e(W),E&&E(W,o))}),[W,o,E]);return n.useEffect((function(){T()}),[T]),n.useEffect((function(){void 0!==s&&(w(s),y.current=e(s))}),[s]),n.useImperativeHandle(u,(function(){return{focus:N.current.focus}})),n.createElement("div",{className:l("range-input",i,{disabled:m===d}),style:{"--mri-thumb-size":"".concat(p,"px"),"--mri-slider-height":"".concat(b,"px")}},n.createElement("div",{className:l("range-area")},n.createElement("div",null,n.createElement("input",{ref:N,type:"range",value:W[0],min:m,max:d,step:v,onChange:function(e){return U("left",e)},onMouseUp:V,onMouseLeave:V,onTouchEnd:V}),n.createElement("input",{ref:M,type:"range",value:W[1],id:"input-right",min:m,max:d,step:v,onChange:function(e){return U("right",e)},onMouseUp:V,onMouseLeave:V,onTouchEnd:V}),n.createElement("div",{className:l("slider")},n.createElement("div",{className:l("track")}),n.createElement("div",{className:l("range"),style:{left:"".concat(I[0],"%"),right:"".concat(100-I[1],"%")}}),n.createElement("div",{className:l("thumb","left"),style:{left:"".concat(I[0],"%")}}),n.createElement("div",{className:l("thumb","right"),style:{right:"".concat(100-I[1],"%")}})))),n.createElement("div",{className:l("range-input")},n.createElement("div",{className:l("input-box")},n.createElement("label",{htmlFor:"rangeMinInput"},"min"),n.createElement("input",{ref:C,type:"text",inputMode:"numeric",disabled:m===d,onBlur:function(e){return U("left",e,!0)},onKeyDown:S})),n.createElement("div",{className:l("input-box")},n.createElement("label",{htmlFor:"rangeMaxInput"},"max"),n.createElement("input",{ref:R,type:"text",inputMode:"numeric",disabled:m===d,onBlur:function(e){return U("right",e,!0)},onKeyDown:S}))))}));c.displayName="MultiRangeInput",module.exports=c;
