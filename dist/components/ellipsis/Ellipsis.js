"use strict";var e=require("@babel/runtime/helpers/slicedToArray"),t=require("@babel/runtime/helpers/toConsumableArray"),i=require("react"),n=require("./Ellipsis.module.scss.js"),r=require("../../utils/forReactUtils.js"),s=require("../../assets/svgs/ico-ellipsis-chevron.svg.js");"undefined"==typeof window&&(i.useLayoutEffect=i.useEffect);var l=r.makeCxFunc(n),o=function(n){var r=n.className,o=n.content,u=void 0===o?"":o,c=n.triggerMore,a=void 0===c?"more":c,h=n.triggerLess,f=void 0===h?"less":h,g=n.lineClamp,m=void 0===g?2:g,v=n.defaultShortened,p=void 0!==v&&v,d=n.observingEnvs,H=void 0===d?[]:d,b=n.onShowMoreLessClick,y=i.useRef(null),C=i.useRef(!1),E=i.useRef(t(H)),k=i.useState(p),L=e(k,2),x=L[0],q=L[1],w=i.useState(!0),N=e(w,2),S=N[0],M=N[1],R=i.useMemo((function(){var e,t,n=x?{lineClamp:m,WebkitLineClamp:m,height:null===(e=y.current)||void 0===e?void 0:e.style.minHeight}:{lineClamp:"unset",WebkitLineClamp:"unset",height:null===(t=y.current)||void 0===t?void 0:t.style.maxHeight};return"string"==typeof u?i.createElement("div",{ref:y,className:l("ellipsis-content"),style:n,dangerouslySetInnerHTML:{__html:u}}):i.createElement("div",{ref:y,className:l("ellipsis-content"),style:n},u)}),[u,m,x]),j=i.useCallback((function(e){var t=y.current;if(t){var i=t.style;if(e){var n=e.openHeight,r=e.closeHeight;i.maxHeight="".concat(n,"px"),i.minHeight="".concat(r,"px"),i.height="".concat(r,"px")}else i.maxHeight="",i.minHeight="",i.height=""}}),[]),A=i.useCallback((function(){j(null),q(!0),C.current=!0}),[j]),T=i.useCallback((function(e){var t=e.openHeight,i=e.closeHeight;j({openHeight:t,closeHeight:i}),M(i+10<t),q(p),C.current=!1}),[p,j]),W=i.useCallback((function(e){e.stopPropagation(),q((function(e){return!e}))}),[]);return i.useLayoutEffect((function(){y.current&&A()}),[A]),i.useLayoutEffect((function(){y.current&&(!!H.length&&H.some((function(e,t){return e!==E.current[t]}))&&(E.current=t(H),A()))}),[H,A,T]),i.useLayoutEffect((function(){var e=y.current;x&&C.current&&e&&T({openHeight:e.scrollHeight,closeHeight:e.offsetHeight})}),[x,u,H,T]),i.createElement("div",{className:l("ellipsis-wrap",r,{shortened:x,"enable-show-more":b})},R,S&&i.createElement("button",{onClick:b||W,className:l("btn-ellipsis-trigger")},x?a:f,i.createElement(s,{width:14,height:14})))};module.exports=o;
