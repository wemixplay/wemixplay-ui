"use strict";var e=require("react"),t=require("./Ellipsis.module.scss.js"),s=require("../../utils/forReactUtils.js"),n=require("../../assets/svgs/ico-ellipsis-chevron.svg.js");"undefined"==typeof window&&(e.useLayoutEffect=e.useEffect);const i=s.makeCxFunc(t);var l=t=>{let{className:s,content:l="",triggerMore:r="more",triggerLess:c="less",lineClamp:o=2,defaultShortened:a=!1,observingEnvs:u=[],onShowMoreLessClick:g}=t;const h=e.useRef(null),m=e.useRef(!1),f=e.useRef([...u]),[p,d]=e.useState(a),[H,v]=e.useState(!0),y=e.useMemo((()=>{var t,s;const n=p?{lineClamp:o,WebkitLineClamp:o,height:null===(t=h.current)||void 0===t?void 0:t.style.minHeight}:{lineClamp:"unset",WebkitLineClamp:"unset",height:null===(s=h.current)||void 0===s?void 0:s.style.maxHeight};return"string"==typeof l?e.createElement("div",{ref:h,className:i("ellipsis-content"),style:n,dangerouslySetInnerHTML:{__html:l}}):e.createElement("div",{ref:h,className:i("ellipsis-content"),style:n},l)}),[l,o,p]),C=e.useCallback((e=>{const{current:t}=h;if(t){const{style:s}=t;if(e){const{openHeight:t,closeHeight:n}=e;s.maxHeight="".concat(t,"px"),s.minHeight="".concat(n,"px"),s.height="".concat(n,"px")}else s.maxHeight="",s.minHeight="",s.height=""}}),[]),E=e.useCallback((()=>{C(null),d(!0),m.current=!0}),[C]),b=e.useCallback((e=>{let{openHeight:t,closeHeight:s}=e;C({openHeight:t,closeHeight:s}),v(s+10<t),d(a),m.current=!1}),[a,C]),k=e.useCallback((e=>{e.stopPropagation(),d((e=>!e))}),[]);return e.useLayoutEffect((()=>{const{current:e}=h;e&&E()}),[E]),e.useLayoutEffect((()=>{const{current:e}=h;if(e){!!u.length&&u.some(((e,t)=>e!==f.current[t]))&&(f.current=[...u],E())}}),[u,E,b]),e.useLayoutEffect((()=>{const{current:e}=h;p&&m.current&&e&&b({openHeight:e.scrollHeight,closeHeight:e.offsetHeight})}),[p,l,u,b]),e.createElement("div",{className:i("ellipsis-wrap",s,{shortened:p,"enable-show-more":g})},y,H&&e.createElement("button",{onClick:g||k,className:i("btn-ellipsis-trigger")},p?r:c,e.createElement(n,{width:14,height:14})))};module.exports=l;
