"use client";
"use strict";var e=require("react"),t=require('./../../ext/swiper/swiper-react.js'),n=require("../../utils/forReactUtils.js"),r=require("../ripple/Ripple.js"),s=require("./Tab.module.scss.js");const a=n.makeCxFunc(s);var l=n=>{let{className:s="",tabItems:l,activeKey:i,name:c,slider:d,swipeContent:o,disabled:u,rippleOption:v={disabled:!0},tabNavScrollRef:b,destroyInactiveTabPanel:f=!0,onClick:m,handleChange:y}=n;var p;const h=e.useRef(null),k=e.useRef(null),E=e.useRef([]),w=e.useRef(),N=e.useRef(!1),x=e.useMemo((()=>{var e;return null!==(e=null==l?void 0:l.filter((e=>!(null==e?void 0:e.isHide))))&&void 0!==e?e:[]}),[l]),[C,R]=e.useState(null!=i?i:null===(p=x[0])||void 0===p?void 0:p.key),I=e.useMemo((()=>{const e=x.findIndex((e=>e.key===C));return-1===e?0:e}),[C,x]),S=e.useMemo((()=>{var n,r,s;if(!x.length)return[];if(o){const n=()=>{var e,t;const{swipeDirection:n}=w.current,{key:r,disabled:s}=x[w.current.activeIndex],{key:a}=null!==(e=x[w.current.activeIndex-1])&&void 0!==e?e:x[0],{key:l}=null!==(t=x[w.current.activeIndex+1])&&void 0!==t?t:x[w.current.activeIndex];s?(R("next"===n?l:a),y&&y("next"===n?l:a,c)):(R(r),y&&y(r,c))};return e.createElement(t.Swiper,{className:a("tab-content-holder"),autoHeight:!0,threshold:1,slidesPerView:1,enabled:!u,onSwiper:e=>{w.current=e},onSlideChange:n},x.map(((n,r)=>e.createElement(t.SwiperSlide,{key:n.key,className:a("tabs-content","active",{disabled:u||n.disabled}),style:{visibility:n.disabled?"hidden":"visible"}},n.children))))}return f?e.createElement("div",{key:"contents-".concat(null===(n=x[I])||void 0===n?void 0:n.key),className:a("tab-content-holder")},e.createElement("div",{className:a("tabs-content","active",{disabled:u||(null===(r=x[I])||void 0===r?void 0:r.disabled)})},null===(s=x[I])||void 0===s?void 0:s.children)):e.createElement("div",{className:a("tab-content-holder")},x.map(((t,n)=>e.createElement("div",{key:"contents-".concat(t.key),className:a("tabs-content",{active:I===n,disabled:u||t.disabled})},t.children))))}),[I,f,u,y,c,o,x]),L=e.useCallback((()=>{var e,t;const n=null!==(e=null==b?void 0:b.current)&&void 0!==e?e:k.current,r=null!==(t=E.current.find((e=>e&&e.classList.contains("active"))))&&void 0!==t?t:E.current[0];if(r){const{offsetLeft:e,clientWidth:t}=r,s=e-n.offsetWidth/2+t/2;n.scrollTo({top:0,left:s,behavior:"smooth"})}}),[b]),g=e.useCallback((()=>{var e;const t=h.current;if(!d||!t)return;const n=null!==(e=E.current.find((e=>e&&e.classList.contains("active"))))&&void 0!==e?e:E.current[0];if(n){const{offsetLeft:e,clientWidth:r}=n;t.style.transform="translateX(".concat(e,"px)"),t.style.width="".concat(r,"px"),N.current?t.style.transition="":(t.style.transition="none",N.current=!0)}else t.style.transform="translateX(0px)",t.style.width="0px"}),[d]),j=e.useCallback(((e,t)=>{void 0===i&&R(e),y&&y(e,c),m&&m(e,t)}),[i,c,y,m]),q=e.useMemo((()=>{if("undefined"!=typeof window)return new ResizeObserver((()=>{g()}))}),[g]);return e.useEffect((()=>{void 0!==i&&i!==C&&R(i)}),[i,C]),e.useEffect((()=>{g(),L(),w.current&&w.current.slideTo(I,250)}),[I,g,L]),e.useEffect((()=>{const e=()=>{g(),L()};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[g,L]),e.useEffect((()=>{o&&w.current&&(u?w.current.disable():w.current.enable())}),[u,o]),e.useEffect((()=>{if(q){const e=E.current;return e.forEach((e=>{e&&q.observe(e)})),()=>{e.forEach((e=>{e&&q.unobserve(e)}))}}}),[q]),e.createElement("div",{className:a(s,"tab",{"swipe-content":o})},e.createElement("div",{className:a("tab-nav-wrap")},e.createElement("div",{ref:k,className:a("tab-nav-scroll")},e.createElement("div",{className:a("tab-nav")},x.map(((t,n)=>e.createElement(r.default,Object.assign({key:t.key},v,{disabled:v.disabled||t.disabled||u}),e.createElement("button",{ref:e=>{E.current[n]=e},key:t.key,role:"tab",className:a("tab-btn",{active:C===t.key}),disabled:u||t.disabled,onClick:e=>j(t.key,e)},t.label)))),d&&e.createElement("span",{ref:h,className:a("slider")})))),S)};module.exports=l;
