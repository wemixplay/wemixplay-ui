"use strict";var e=require("@babel/runtime/helpers/slicedToArray"),t=require("react"),n=require('./../../ext/swiper/swiper-react.js'),r=require("../../utils/forReactUtils.js"),i=require("../ripple/Ripple.js"),a=require("./Tab.module.scss.js"),c=r.makeCxFunc(a);module.exports=function(r){var a,l=r.className,s=void 0===l?"":l,u=r.tabItems,o=r.activeKey,d=r.name,f=r.slider,v=r.swipeContent,b=r.disabled,m=r.rippleOption,y=void 0===m?{disabled:!0}:m,p=r.tabNavScrollRef,h=r.destroyInactiveTabPanel,k=void 0===h||h,E=r.onClick,w=r.handleChange,N=t.useRef(null),x=t.useRef(null),C=t.useRef([]),R=t.useRef(),I=t.useRef(!1),S=t.useMemo((function(){var e;return null!==(e=null==u?void 0:u.filter((function(e){return!(null==e?void 0:e.isHide)})))&&void 0!==e?e:[]}),[u]),q=t.useState(null!=o?o:null===(a=S[0])||void 0===a?void 0:a.key),L=e(q,2),g=L[0],j=L[1],T=t.useMemo((function(){var e=S.findIndex((function(e){return e.key===g}));return-1===e?0:e}),[g,S]),M=t.useMemo((function(){var e,r,i;if(!S.length)return[];if(v){return t.createElement(n.Swiper,{className:c("tab-content-holder"),autoHeight:!0,threshold:1,slidesPerView:1,enabled:!b,onSwiper:function(e){R.current=e},onSlideChange:function(){var e,t,n=R.current.swipeDirection,r=S[R.current.activeIndex],i=r.key,a=r.disabled,c=(null!==(e=S[R.current.activeIndex-1])&&void 0!==e?e:S[0]).key,l=(null!==(t=S[R.current.activeIndex+1])&&void 0!==t?t:S[R.current.activeIndex]).key;a?(j("next"===n?l:c),w&&w("next"===n?l:c,d)):(j(i),w&&w(i,d))}},S.map((function(e,r){return t.createElement(n.SwiperSlide,{key:e.key,className:c("tabs-content","active",{disabled:b||e.disabled}),style:{visibility:e.disabled?"hidden":"visible"}},e.children)})))}return k?t.createElement("div",{key:"contents-".concat(null===(e=S[T])||void 0===e?void 0:e.key),className:c("tab-content-holder")},t.createElement("div",{className:c("tabs-content","active",{disabled:b||(null===(r=S[T])||void 0===r?void 0:r.disabled)})},null===(i=S[T])||void 0===i?void 0:i.children)):t.createElement("div",{className:c("tab-content-holder")},S.map((function(e,n){return t.createElement("div",{key:"contents-".concat(e.key),className:c("tabs-content",{active:T===n,disabled:b||e.disabled})},e.children)})))}),[T,k,b,w,d,v,S]),z=t.useCallback((function(){var e,t,n=null!==(e=null==p?void 0:p.current)&&void 0!==e?e:x.current,r=null!==(t=C.current.find((function(e){return e&&e.classList.contains("active")})))&&void 0!==t?t:C.current[0];if(r){var i=r.offsetLeft,a=r.clientWidth,c=i-n.offsetWidth/2+a/2;n.scrollTo({top:0,left:c,behavior:"smooth"})}}),[p]),O=t.useCallback((function(){var e,t=N.current;if(f&&t){var n=null!==(e=C.current.find((function(e){return e&&e.classList.contains("active")})))&&void 0!==e?e:C.current[0];if(n){var r=n.offsetLeft,i=n.clientWidth;t.style.transform="translateX(".concat(r,"px)"),t.style.width="".concat(i,"px"),I.current?t.style.transition="":(t.style.transition="none",I.current=!0)}else t.style.transform="translateX(0px)",t.style.width="0px"}}),[f]),W=t.useCallback((function(e,t){void 0===o&&j(e),w&&w(e,d),E&&E(e,t)}),[o,d,w,E]),H=t.useMemo((function(){if("undefined"!=typeof window)return new ResizeObserver((function(){O()}))}),[O]);return t.useEffect((function(){void 0!==o&&o!==g&&j(o)}),[o,g]),t.useEffect((function(){O(),z(),R.current&&R.current.slideTo(T,250)}),[T,O,z]),t.useEffect((function(){var e=function(){O(),z()};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[O,z]),t.useEffect((function(){v&&R.current&&(b?R.current.disable():R.current.enable())}),[b,v]),t.useEffect((function(){if(H){var e=C.current;return e.forEach((function(e){e&&H.observe(e)})),function(){e.forEach((function(e){e&&H.unobserve(e)}))}}}),[H]),t.createElement("div",{className:c(s,"tab",{"swipe-content":v})},t.createElement("div",{className:c("tab-nav-wrap")},t.createElement("div",{ref:x,className:c("tab-nav-scroll")},t.createElement("div",{className:c("tab-nav")},S.map((function(e,n){return t.createElement(i.default,Object.assign({key:e.key},y,{disabled:y.disabled||e.disabled||b}),t.createElement("button",{ref:function(e){C.current[n]=e},key:e.key,role:"tab",className:c("tab-btn",{active:g===e.key}),disabled:b||e.disabled,onClick:function(t){return W(e.key,t)}},e.label))})),f&&t.createElement("span",{ref:N,className:c("slider")})))),M)};
