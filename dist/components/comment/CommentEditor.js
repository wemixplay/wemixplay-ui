"use strict";var e=require("@babel/runtime/helpers/slicedToArray"),t=require("../../_virtual/_tslib.js"),r=require("react"),a=require("./CommentEditor.module.scss.js"),n=require("../../utils/forReactUtils.js"),i=require("./CommentWriterInfo.js"),l=require("../buttons/SolidCapButton.js"),o=require("../editor/WpEditor.js"),s=require("../../plugins/mention/Mention.js"),u=require("../../plugins/autoUrlMatch/AutoUrlMatch.js"),c=require("../../plugins/countTextLength/CountTextLength.js"),m=require("../../plugins/pasteToPlainText/PasteToPlainText.js"),d=require("../../utils/valueParserUtils.js"),h=n.makeCxFunc(a),g=r.forwardRef((function(a,n){var g,v=a.className,f=void 0===v?"":v,p=a.writerName,b=a.writerImg,T=a.btnSubmitText,x=void 0===T?"POST":T,j=a.value,C=a.config,N=a.minLength,q=void 0===N?1:N,S=a.maxLength,E=void 0===S?1e3:S,k=a.placeholder,w=a.name,L=a.handleChange,M=a.handleSubmit,U=t.__rest(a,["className","writerName","writerImg","btnSubmitText","value","config","minLength","maxLength","placeholder","name","handleChange","handleSubmit"]),P=r.useRef(),H=r.useState(d.convertMarkdownToHtmlStr(null!=j?j:"")),I=e(H,2),_=I[0],O=I[1],R=r.useState(null!==(g=null==j?void 0:j.length)&&void 0!==g?g:0),W=e(R,2),A=W[0],V=W[1],y=r.useCallback((function(e){return e.textUrls.map((function(e){return'<a href="'.concat(e,'" target="_blank">').concat(e,"</a>")}))}),[]),B=r.useCallback((function(e,t){var r=d.convertHtmlToMarkdownStr(e);O(r),L&&L(r,t)}),[w,L]),D=r.useCallback((function(){M&&M(_)}),[_,M]);return r.useEffect((function(){if(j&&!_){var e=d.convertMarkdownToHtmlStr(j);O(e)}}),[j,_]),r.useImperativeHandle(n,(function(){var e=P.current.setData;return P.current.setData=function(t,r){var a=d.convertMarkdownToHtmlStr(t);e(a,r)},P.current})),r.createElement("div",{className:h(f,"comment-editor")},r.createElement(i,{className:h("editor-profile"),writerName:p,writerImg:b}),r.createElement("div",{className:h("editor-area")},r.createElement(o,Object.assign({className:h("editor",{filled:_.length}),plugin:[s,u,m,c],config:Object.assign(Object.assign({},C),{pasteToPlainText:{onMatchUrlReplace:y},autoUrlMatch:{onMatchUrl:function(e){return y({textUrls:[e]})}},countTextLength:{hideUi:!0,onChangeTextLength:V}}),name:w,initialValue:_,placeholder:k,maxLength:E,handleChange:B},U,{ref:P}))),r.createElement("div",{className:h("editor-tool")},r.createElement("em",{className:h("counter-current")},d.commaWithValue(A)),"/",r.createElement("span",{className:h("counter-max")},d.commaWithValue(E)),r.createElement(l,{size:"medium",className:h("btn-post"),disabled:q>A||!d.removeSpaceAndLineBreak(_),onClick:D},x)))}));g.displayName="CommentEditor";var v=g;module.exports=v;
