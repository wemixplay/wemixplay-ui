"use client";
"use strict";var e=require("../../_virtual/_tslib.js"),t=require("react"),a=require("./CommentEditor.module.scss.js"),r=require("../../utils/forReactUtils.js"),n=require("./CommentWriterInfo.js"),l=require("../buttons/SolidCapButton.js"),i=require("../editor/WpEditor.js"),s=require("../../plugins/mention/Mention.js"),o=require("../../plugins/autoUrlMatch/AutoUrlMatch.js"),m=require("../../plugins/countTextLength/CountTextLength.js"),c=require("../../plugins/pasteToPlainText/PasteToPlainText.js"),u=require("../../utils/valueParserUtils.js"),d=require('./../../ext/lodash/merge.js');const h=r.makeCxFunc(a),g=t.forwardRef(((a,r)=>{var g,{className:p="",writerName:b,writerImg:v,btnSubmitText:x="POST",value:T,config:f,minLength:S=1,maxLength:C=1e3,placeholder:N,name:j,isSubmitDisabled:q=!1,handleChange:E,handleSubmit:k}=a,w=e.__rest(a,["className","writerName","writerImg","btnSubmitText","value","config","minLength","maxLength","placeholder","name","isSubmitDisabled","handleChange","handleSubmit"]);const L=t.useRef(),[M,U]=t.useState(u.convertMarkdownToHtmlStr(null!=T?T:"")),[P,_]=t.useState(null!==(g=null==T?void 0:T.length)&&void 0!==g?g:0),H=t.useCallback((e=>{let{textUrls:t}=e;return t.map((e=>'<a href="'.concat(e,'" target="_blank">').concat(e,"</a>")))}),[]),I=t.useCallback(((e,t)=>{const a=u.convertHtmlToMarkdownStr(e);U(a),E&&E(a,t)}),[j,E]),D=t.useCallback((()=>{k&&k(M)}),[M,k]);return t.useEffect((()=>{if(T&&!M){const e=u.convertMarkdownToHtmlStr(T);U(e)}}),[T,M]),t.useImperativeHandle(r,(()=>{const{setData:e}=L.current;return L.current.setData=(t,a)=>{const r=u.convertMarkdownToHtmlStr(t);e(r,a)},L.current})),t.createElement("div",{className:h(p,"comment-editor")},t.createElement(n,{className:h("editor-profile"),writerName:b,writerImg:v}),t.createElement("div",{className:h("editor-area")},t.createElement(i,Object.assign({className:h("editor",{filled:M.length}),plugin:[s,o,c,m],config:d({pasteToPlainText:{onMatchUrlReplace:H},autoUrlMatch:{onMatchUrl:e=>H({textUrls:[e]})},countTextLength:{hideUi:!0,onChangeTextLength:_}},f),name:j,initialValue:M,placeholder:N,maxLength:C,handleChange:I},w,{ref:L}))),t.createElement("div",{className:h("editor-tool")},t.createElement("em",{className:h("counter-current")},u.commaWithValue(P)),"/",t.createElement("span",{className:h("counter-max")},u.commaWithValue(C)),t.createElement(l,{size:"medium",className:h("btn-post"),disabled:S>P||!u.removeSpaceAndLineBreak(M)||q,onClick:D},x)))}));g.displayName="CommentEditor";var p=g;module.exports=p;
