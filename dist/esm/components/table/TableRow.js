"use client";
import{__awaiter as e}from"../../_virtual/_tslib.js";import r,{useRef as l,useState as t,useCallback as n,useMemo as a,useEffect as o}from"react";import{makeCxFunc as s}from"../../utils/forReactUtils.js";import{wait as i}from"../../utils/etcUtils.js";import p from"./Table.module.scss.js";const c=s(p),d=s=>{let{className:p="",children:d,expendOpen:m=!1,handleExpendChange:u,beforeExpendOpen:y,onClick:f}=s;const v=l(null),[h,x]=t(m),b=n((e=>{if(v.current){const r="boolean"==typeof e?e:!h,l=v.current.firstChild;l&&(l.style.maxHeight=r?"".concat(l.scrollHeight,"px"):"0px")}}),[v,h]),g=n((()=>e(void 0,void 0,void 0,(function*(){try{y&&!h&&(yield y(),yield i(10))}catch(e){console.error(e)}finally{x(!h),u&&u(!h)}}))),[h,u,y]),j=a((()=>{const e=r=>r.flatMap((r=>{var l;return(null==r?void 0:r.props)?"TdColumn"===(null===(l=r.type)||void 0===l?void 0:l.displayName)?Object.assign(Object.assign({},r),{props:Object.assign(Object.assign({},r.props),{handleExpendToggle:g,expendOpen:m})}):Array.isArray(r.props.children)?e(r.props.children):[]:[]})),r=Array.isArray(d)?d:[d];return e(r)}),[d,m,g]),A=a((()=>{const e=r=>r.flatMap((r=>{var l;if(null==r?void 0:r.props)return"TdExpend"===(null===(l=r.type)||void 0===l?void 0:l.displayName)?r:Array.isArray(r.props.children)?e(r.props.children):void 0})),r=Array.isArray(d)?d:[d];return e(r).filter((e=>e))[0]}),[d]);return o((()=>{b(h)}),[h,b]),o((()=>{void 0!==m&&x(m)}),[m]),r.createElement(r.Fragment,null,r.createElement("tr",{className:c(p,"table-row"),onClick:f},j),!!A&&r.createElement("tr",{className:c("expend-tr")},r.createElement("td",{ref:v,className:c("expend-table-cell",{open:h}),colSpan:j.length},A)))};d.displayName="TableRow";var m=d;export{m as default};
