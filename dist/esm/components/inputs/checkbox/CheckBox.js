import e,{forwardRef as r,useRef as a,useId as n,useMemo as t,useCallback as l,useEffect as s,useImperativeHandle as c}from"react";import o from"./CheckBox.module.scss.js";import i from"../../../assets/svgs/ico-check.svg.js";import m from"../../../assets/svgs/ico-indeterminate.svg.js";import{makeCxFunc as u}from"../../../utils/forReactUtils.js";import d from"../../../node_modules/lodash/uniq.js";const y=u(o),h=r(((r,o)=>{const{className:u="",name:h,size:A="normal",checkValue:f=!0,unCheckValue:p=!1,value:g,children:v,disabled:k,readOnly:b,onChange:E,onBlur:x,onFocus:N,handleChange:C}=r,B=a(null),j=n(),w=t((()=>{if(void 0!==g)return Array.isArray(f)&&Array.isArray(g)?g.length===f.length&&g.every((e=>f.includes(e))):Array.isArray(g)?g.includes(f):g===f}),[g,f]),q=t((()=>!w&&(!(!Array.isArray(f)||!Array.isArray(g))&&(g.length!==f.length&&g.some((e=>f.includes(e)))))),[w,f,g]),S=l((e=>{const{name:r,checked:a}=e.target,n='input[name="'.concat(r,'"]'),t=document.querySelectorAll(n);if(Array.isArray(f)&&Array.isArray(g))C&&C(g.length>0?[]:f,r);else{if(t.length>1||Array.isArray(g)){const e=document.querySelectorAll("".concat(n,":checked"));let a=[];const t=f,l=g?[...g]:void 0;for(let r=0;r<e.length;r+=1){const n="number"==typeof f?Number(e[r].value):e[r].value;-1===a.findIndex((e=>e===n))&&a.push(n)}l&&void 0!==t&&l.push(t),a=l?l.filter((e=>a.includes(e))):d(a),C&&C(a,r)}else C&&C(a?f:p,r);E&&E(e)}}),[g,p,C,E,f]);return s((()=>{const e='input[name="'.concat(h||j,'"]');if(document.querySelectorAll(e).length>1||Array.isArray(g)){if("boolean"==typeof f)throw new Error("여러개의 동일한 name 값을 갖거나 data가 배열로 전달된 CheckBox는 boolean타입의 value를 받을 수 없습니다.")}else if(Array.isArray(g))throw new Error("단일의 name 값을 갖는 CheckBox는 배열 타입의 data를 가질 수 없습니다.")}),[g,h,j,f]),s((()=>{B.current&&(B.current.indeterminate=q)}),[q]),c(o,(()=>B.current)),e.createElement("div",{className:y(u,"checkbox",A,{readonly:b,disabled:k,"not-allow":b||k})},e.createElement("label",null,e.createElement("input",{ref:B,type:"checkbox",name:Array.isArray(f)?j:h||j,value:String(f),checked:w,readOnly:b,disabled:k,onBlur:x,onFocus:N,onChange:S}),e.createElement("span",{className:y("ico-check")},e.createElement("i",{className:y("icon")},q?e.createElement(m,{className:y("partial")}):e.createElement(i,{className:y("check")}))),e.createElement("span",{className:y("text")},v)))}));h.displayName="CheckBox";var A=h;export{A as default};
