import e from"@babel/runtime/helpers/toConsumableArray";import t from"@babel/runtime/helpers/slicedToArray";import r,{forwardRef as n,useRef as a,useState as l,useMemo as u,useCallback as o,useEffect as i,useImperativeHandle as c}from"react";import{makeCxFunc as m}from"../../../utils/forReactUtils.js";import{commaWithValue as s,commaStrToNumber as d}from"../../../utils/valueParserUtils.js";import p from"./MultiRangeInput.module.scss.js";var f=m(p),v=n((function(n,m){var p=n.className,v=void 0===p?"":p,h=n.value,g=n.name,b=n.min,E=n.max,x=n.step,y=void 0===x?1:x,M=n.thumbSize,N=void 0===M?26:M,C=n.sliderHeight,w=void 0===C?6:C,I=n.thumbBorderColor,k=n.thumbColor,T=n.trackColor,U=n.rangeColor,j=n.showTextInput,B=void 0===j||j,R=n.handleChange,z=n.onChange,A=a([b,E]),D=a(null),F=a(null),K=a(null),L=a(null),V=l([b,E]),W=t(V,2),H=W[0],P=W[1],S=u((function(){return H.map((function(e){return(e-b)/(E-b)*100}))}),[H,b,E]),q=o((function(){K.current&&L.current&&(K.current.value=s(H[0]),L.current.value=s(H[1]),K.current.style.width="".concat(K.current.scrollWidth,"px"),L.current.style.width="".concat(L.current.scrollWidth,"px"))}),[H]),G=o((function(e){"Enter"!==e.key||e.nativeEvent.isComposing||(K.current.blur(),L.current.blur())}),[]),J=o((function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!B||K.current&&L.current){var n=t.target.value;if("left"===e){var a=Math.min(d(n),H[1]-y);P([a=a>b?a:b,H[1]]),r&&R&&R([a,H[1]],g),K.current.value=s(a)}else{var l=Math.max(d(n),H[0]+y);l=l<=E?l:E,P([H[0],l]),r&&R&&R([H[0],l],g),L.current.value=s(l)}z&&z(t),q()}}),[z,B,q,R,g,H,y,b,E]),O=o((function(){H.some((function(e,t){return e!==A.current[t]}))&&(A.current=e(H),R&&R(H,g))}),[H,g,R]);return i((function(){q()}),[q]),i((function(){void 0!==h&&(P(h),A.current=e(h))}),[h]),c(m,(function(){return{focus:D.current.focus}})),r.createElement("div",{className:f("range-input",v,{disabled:b===E}),style:{"--mri-thumb-size":"".concat(N,"px"),"--mri-slider-height":"".concat(w,"px"),"--mri-thumb-border-color":I,"--mri-thumb-color":k,"--mri-track-color":T,"--mri-range-color":U}},r.createElement("div",{className:f("range-area")},r.createElement("div",null,r.createElement("input",{ref:D,type:"range",value:H[0],min:b,max:E,step:y,onChange:function(e){return J("left",e)},onMouseUp:O,onMouseLeave:O,onTouchEnd:O}),r.createElement("input",{ref:F,type:"range",value:H[1],id:"input-right",min:b,max:E,step:y,onChange:function(e){return J("right",e)},onMouseUp:O,onMouseLeave:O,onTouchEnd:O}),r.createElement("div",{className:f("slider")},r.createElement("div",{className:f("track")}),r.createElement("div",{className:f("range"),style:{left:"".concat(S[0],"%"),right:"".concat(100-S[1],"%")}}),r.createElement("div",{className:f("thumb","left"),style:{left:"".concat(S[0],"%")}}),r.createElement("div",{className:f("thumb","right"),style:{right:"".concat(100-S[1],"%")}})))),B&&r.createElement("div",{className:f("range-input")},r.createElement("div",{className:f("input-box")},r.createElement("label",{htmlFor:"rangeMinInput"},"min"),r.createElement("input",{ref:K,type:"text",inputMode:"numeric",defaultValue:H[0],disabled:b===E,onBlur:function(e){return J("left",e,!0)},onKeyDown:G})),r.createElement("div",{className:f("input-box")},r.createElement("label",{htmlFor:"rangeMaxInput"},"max"),r.createElement("input",{ref:L,type:"text",inputMode:"numeric",defaultValue:H[1],disabled:b===E,onBlur:function(e){return J("right",e,!0)},onKeyDown:G}))))}));v.displayName="MultiRangeInput";var h=v;export{h as default};
