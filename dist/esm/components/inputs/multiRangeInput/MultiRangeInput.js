import e from"@babel/runtime/helpers/toConsumableArray";import t from"@babel/runtime/helpers/slicedToArray";import n,{forwardRef as r,useRef as a,useState as u,useMemo as l,useCallback as i,useEffect as c,useImperativeHandle as o}from"react";import{makeCxFunc as m}from"../../../utils/forReactUtils.js";import{commaWithValue as s,commaStrToNumber as d}from"../../../utils/valueParserUtils.js";import p from"./MultiRangeInput.module.scss.js";var f=m(p),v=r((function(r,m){var p=r.className,v=void 0===p?"":p,h=r.value,g=r.name,E=r.min,b=r.max,y=r.step,x=void 0===y?1:y,M=r.thumbSize,N=void 0===M?26:M,C=r.sliderHeight,w=void 0===C?6:C,I=r.handleChange,U=r.onChange,j=a([E,b]),R=a(null),T=a(null),k=a(null),z=a(null),A=u([E,b]),B=t(A,2),D=B[0],F=B[1],K=l((function(){return D.map((function(e){return(e-E)/(b-E)*100}))}),[D,E,b]),L=i((function(){k.current&&z.current&&(k.current.value=s(D[0]),z.current.value=s(D[1]),k.current.style.width="".concat(k.current.scrollWidth,"px"),z.current.style.width="".concat(z.current.scrollWidth,"px"))}),[D]),W=i((function(e){"Enter"!==e.key||e.nativeEvent.isComposing||(k.current.blur(),z.current.blur())}),[]),H=i((function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(k.current&&z.current){var r=t.target.value;if("left"===e){var a=Math.min(d(r),D[1]-x);F([a=a>E?a:E,D[1]]),n&&I&&I([a,D[1]],g),k.current.value=s(a)}else{var u=Math.max(d(r),D[0]+x);u=u<=b?u:b,F([D[0],u]),n&&I&&I([D[0],u],g),z.current.value=s(u)}U&&U(t),L()}}),[U,L,I,g,D,x,E,b]),P=i((function(){D.some((function(e,t){return e!==j.current[t]}))&&(j.current=e(D),I&&I(D,g))}),[D,g,I]);return c((function(){L()}),[L]),c((function(){void 0!==h&&(F(h),j.current=e(h))}),[h]),o(m,(function(){return{focus:R.current.focus}})),n.createElement("div",{className:f("range-input",v,{disabled:E===b}),style:{"--mri-thumb-size":"".concat(N,"px"),"--mri-slider-height":"".concat(w,"px")}},n.createElement("div",{className:f("range-area")},n.createElement("div",null,n.createElement("input",{ref:R,type:"range",value:D[0],min:E,max:b,step:x,onChange:function(e){return H("left",e)},onMouseUp:P,onMouseLeave:P,onTouchEnd:P}),n.createElement("input",{ref:T,type:"range",value:D[1],id:"input-right",min:E,max:b,step:x,onChange:function(e){return H("right",e)},onMouseUp:P,onMouseLeave:P,onTouchEnd:P}),n.createElement("div",{className:f("slider")},n.createElement("div",{className:f("track")}),n.createElement("div",{className:f("range"),style:{left:"".concat(K[0],"%"),right:"".concat(100-K[1],"%")}}),n.createElement("div",{className:f("thumb","left"),style:{left:"".concat(K[0],"%")}}),n.createElement("div",{className:f("thumb","right"),style:{right:"".concat(100-K[1],"%")}})))),n.createElement("div",{className:f("range-input")},n.createElement("div",{className:f("input-box")},n.createElement("label",{htmlFor:"rangeMinInput"},"min"),n.createElement("input",{ref:k,type:"text",inputMode:"numeric",disabled:E===b,onBlur:function(e){return H("left",e,!0)},onKeyDown:W})),n.createElement("div",{className:f("input-box")},n.createElement("label",{htmlFor:"rangeMaxInput"},"max"),n.createElement("input",{ref:z,type:"text",inputMode:"numeric",disabled:E===b,onBlur:function(e){return H("right",e,!0)},onKeyDown:W}))))}));v.displayName="MultiRangeInput";export{v as default};
