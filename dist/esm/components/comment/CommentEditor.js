"use client";
import{__rest as e}from"../../_virtual/_tslib.js";import t,{forwardRef as a,useRef as r,useState as n,useCallback as o,useEffect as m,useImperativeHandle as l}from"react";import i from"./CommentEditor.module.scss.js";import{makeCxFunc as s}from"../../utils/forReactUtils.js";import c from"./CommentWriterInfo.js";import u from"../buttons/SolidCapButton.js";import d from"../editor/WpEditor.js";import p from"../../plugins/mention/Mention.js";import h from"../../plugins/autoUrlMatch/AutoUrlMatch.js";import g from"../../plugins/countTextLength/CountTextLength.js";import f from"../../plugins/pasteToPlainText/PasteToPlainText.js";import{convertMarkdownToHtmlStr as x,convertHtmlToMarkdownStr as N,commaWithValue as j,removeSpaceAndLineBreak as T}from"../../utils/valueParserUtils.js";import b from'./../../ext/lodash/merge.js';const v=s(i),E=a(((a,i)=>{var s,{className:E="",writerName:C,writerImg:U,btnSubmitText:L="POST",value:w,config:M,minLength:P=1,maxLength:S=1e3,placeholder:I,name:_,handleChange:k,handleSubmit:D}=a,O=e(a,["className","writerName","writerImg","btnSubmitText","value","config","minLength","maxLength","placeholder","name","handleChange","handleSubmit"]);const R=r(),[W,y]=n(x(null!=w?w:"")),[z,A]=n(null!==(s=null==w?void 0:w.length)&&void 0!==s?s:0),B=o((e=>{let{textUrls:t}=e;return t.map((e=>'<a href="'.concat(e,'" target="_blank">').concat(e,"</a>")))}),[]),V=o(((e,t)=>{const a=N(e);y(a),k&&k(a,t)}),[_,k]),q=o((()=>{D&&D(W)}),[W,D]);return m((()=>{if(w&&!W){const e=x(w);y(e)}}),[w,W]),l(i,(()=>{const{setData:e}=R.current;return R.current.setData=(t,a)=>{const r=x(t);e(r,a)},R.current})),t.createElement("div",{className:v(E,"comment-editor")},t.createElement(c,{className:v("editor-profile"),writerName:C,writerImg:U}),t.createElement("div",{className:v("editor-area")},t.createElement(d,Object.assign({className:v("editor",{filled:W.length}),plugin:[p,h,f,g],config:b({},M,{pasteToPlainText:{onMatchUrlReplace:B},autoUrlMatch:{onMatchUrl:e=>B({textUrls:[e]})},countTextLength:{hideUi:!0,onChangeTextLength:A}}),name:_,initialValue:W,placeholder:I,maxLength:S,handleChange:V},O,{ref:R}))),t.createElement("div",{className:v("editor-tool")},t.createElement("em",{className:v("counter-current")},j(z)),"/",t.createElement("span",{className:v("counter-max")},j(S)),t.createElement(u,{size:"medium",className:v("btn-post"),disabled:P>z||!T(W),onClick:q},L)))}));E.displayName="CommentEditor";var C=E;export{C as default};
