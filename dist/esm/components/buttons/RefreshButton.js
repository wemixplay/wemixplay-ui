import r from"@babel/runtime/helpers/slicedToArray";import e,{useRef as n,useState as t,useCallback as c,useEffect as o}from"react";import{makeCxFunc as u}from"../../utils/forReactUtils.js";import s from"../../assets/svgs/ico-refresh.svg.js";import i from"./RefreshButton.module.scss.js";var a=u(i),l=function(u){var i=u.className,l=void 0===i?"":i,f=u.duration,m=void 0===f?5:f,d=u.showCount,v=void 0===d||d,h=u.iconElement,p=void 0===h?e.createElement(s,null):h,b=u.disabled,E=void 0!==b&&b,w=u.onClick,N=u.onRefresh,j=n(null),C=n(m||!1),R=n(),T=t(!1),g=r(T,2),k=g[0],y=g[1],A=c((function(){window.clearInterval(j.current),j.current=null}),[]),H=c((function(){j.current&&A(),m&&R.current&&(C.current=m,R.current.innerHTML="".concat(C.current),j.current=window.setInterval((function(){"number"==typeof C.current&&C.current>0?C.current-=1:C.current=m,y(0===C.current),R.current.innerHTML="".concat(C.current>0?C.current:"")}),1e3))}),[m,A]),I=c((function(r){k||(y(!0),H(),w&&w(r))}),[k,w,H]);return o((function(){k&&0===C.current&&(C.current=-1,N&&N())}),[N,k]),o((function(){H()}),[H]),o((function(){E?A():H()}),[E,H,A]),o((function(){return function(){j.current&&A()}}),[A]),e.createElement("span",{className:a("refresh",l)},e.createElement("button",{className:a("btn-refresh"),onClick:I,disabled:E},e.createElement("i",{className:a("btn-refresh-ico",{refreshed:k}),onAnimationEnd:function(){return y(!1)}},p),v&&!!m&&e.createElement("span",{ref:R,className:a("btn-refresh-count")})))};export{l as default};
