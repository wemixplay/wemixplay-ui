import e,{useRef as r,useState as t,useCallback as n,useEffect as c}from"react";import{makeCxFunc as s}from"../../utils/forReactUtils.js";import a from"../../assets/svgs/ico-refresh.svg.js";import o from"./RefreshButton.module.scss.js";const u=s(o);var l=s=>{let{className:o="",duration:l=5,showCount:m=!0,iconElement:i=e.createElement(a,null),disabled:f=!1,onClick:d,onRefresh:h}=s;const p=r(null),b=r(l||!1),E=r(),[v,w]=t(!1),N=n((()=>{window.clearInterval(p.current),p.current=null}),[]),j=n((()=>{p.current&&N(),l&&E.current&&(b.current=l,E.current.innerHTML="".concat(b.current),p.current=window.setInterval((()=>{"number"==typeof b.current&&b.current>0?b.current-=1:b.current=l,w(0===b.current),E.current.innerHTML="".concat(b.current>0?b.current:"")}),1e3))}),[l,N]),C=n((e=>{v||(w(!0),j(),d&&d(e))}),[v,d,j]);return c((()=>{v&&0===b.current&&(b.current=-1,h&&h())}),[h,v]),c((()=>{j()}),[j]),c((()=>{f?N():j()}),[f,j,N]),c((()=>()=>{p.current&&N()}),[N]),e.createElement("span",{className:u("refresh",o)},e.createElement("button",{className:u("btn-refresh"),onClick:C,disabled:f},e.createElement("i",{className:u("btn-refresh-ico",{refreshed:v}),onAnimationEnd:()=>w(!1)},i),m&&!!l&&e.createElement("span",{ref:E,className:u("btn-refresh-count")})))};export{l as default};
