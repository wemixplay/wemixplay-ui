import e from"@babel/runtime/helpers/toConsumableArray";import t from"@babel/runtime/helpers/slicedToArray";import n,{useRef as a,useState as r,useMemo as i,Children as o}from"react";import{makeCxFunc as m}from"../../utils/forReactUtils.js";import u from"./Marquee.module.scss.js";"undefined"==typeof window&&(n.useLayoutEffect=n.useEffect);var c=m(u),s=function(m){var u=m.className,s=m.direction,p=void 0===s?"left":s,d=m.children,g=m.list,v=m.off,S=void 0!==v&&v,y=m.pauseOnMouseEnter,h=void 0!==y&&y,q=m.minimalAuto,I=void 0!==q&&q,b=m.minimalCount,z=void 0===b?0:b,E=m.animationIterationCount,M=void 0===E?"infinite":E,A=m.animationDuration,N=m.animationDelay,w=m.spaceBetween,C=m.onStart,k=m.onIteration,j=m.onFinish,B=a(null),D=r(z),L=t(D,2),x=L[0],O=L[1],H=i((function(){return o.map(d,(function(e,t){return n.createElement("span",{key:t,className:c("marquee-item")},e)}))||g.map((function(e,t){return n.createElement("span",{key:t,className:c("marquee-item")},e)}))}),[d,g]),W=i((function(){for(var t=e(H);x>t.length;)t=[].concat(e(t),e(H));return[].concat(e(t),e(t)).map((function(e,t){return Object.assign(Object.assign({},e),{key:t})}))}),[H,x]);return n.useLayoutEffect((function(){if(I&&B.current){var e=B.current,t=Array.from(e.getElementsByClassName("marquee-item")).slice(0,H.length),n=null==t?void 0:t.length;if(n){var a="left"===p||"right"===p,r=t.reduce((function(e,t){var n=e.sizeSum,r=e.marginSum,i=l(a,t);return{sizeSum:n+i.marqueeItemSize,marginSum:r+i.marqueeItemMargin}}),{sizeSum:0,marginSum:0}),i=r.sizeSum,o=r.marginSum,m=f({totalSize:"number"==typeof w?i+w*n:i+o,containerSize:e[a?"offsetWidth":"offsetHeight"],elementLength:n});O(m)}}}),[I,p,w,H]),n.createElement("div",{ref:B,className:c("marquee-wrapper",{paused:h},u)},n.createElement("div",{className:c("marquee-content",p,{off:S,"space-between":"number"==typeof w}),style:{animationDuration:A,animationDelay:N,animationIterationCount:M,"--space-between":"".concat(w,"px")},onAnimationStart:C,onAnimationIteration:k,onAnimationEnd:j},W))},l=function(e,n){var a=function(e){var n=getComputedStyle(e).margin.replaceAll("px","").split(" ").map(Number).reduce((function(e,t,n){return n%2==0?[e[0]+t,e[1]]:[e[0],e[1]+t]}),[0,0]),a=t(n,2);return{marqueeItemMarginBlock:a[0],marqueeItemMarginInline:a[1]}}(n),r=a.marqueeItemMarginBlock,i=a.marqueeItemMarginInline,o=n.offsetWidth,m=n.offsetHeight;return{marqueeItemSize:e?o:m,marqueeItemMargin:e?i:r}},f=function(e){var t=e.totalSize,n=e.containerSize,a=e.elementLength;return Math.ceil(n/t)*a};export{s as default};
