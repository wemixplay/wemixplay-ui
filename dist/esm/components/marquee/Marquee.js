"use client";
import e,{useRef as t,useState as n,useMemo as a,Children as i}from"react";import{makeCxFunc as r}from"../../utils/forReactUtils.js";import m from"./Marquee.module.scss.js";"undefined"==typeof window&&(e.useLayoutEffect=e.useEffect);const o=r(m),s=(e,t)=>{const{marqueeItemMarginBlock:n,marqueeItemMarginInline:a}=(e=>{const[t,n]=getComputedStyle(e).margin.replaceAll("px","").split(" ").map(Number).reduce(((e,t,n)=>n%2==0?[e[0]+t,e[1]]:[e[0],e[1]+t]),[0,0]);return{marqueeItemMarginBlock:t,marqueeItemMarginInline:n}})(t),{offsetWidth:i,offsetHeight:r}=t;return{marqueeItemSize:e?i:r,marqueeItemMargin:e?a:n}},u=e=>{let{totalSize:t,containerSize:n,elementLength:a}=e;return Math.ceil(n/t)*a};var l=r=>{let{className:m,direction:l="left",children:c,list:f,off:p=!1,pauseOnMouseEnter:g=!1,minimalAuto:d=!1,minimalCount:S=0,animationIterationCount:q="infinite",animationDuration:y,animationDelay:I,spaceBetween:h,onStart:z,onIteration:E,onFinish:M}=r;const b=t(null),[N,w]=n(S),A=a((()=>i.map(c,((t,n)=>e.createElement("span",{key:n,className:o("marquee-item")},t)))||f.map(((t,n)=>e.createElement("span",{key:n,className:o("marquee-item")},t)))),[c,f]),k=a((()=>{let e=[...A];for(;N>e.length;)e=[...e,...A];return[...e,...e].map(((e,t)=>Object.assign(Object.assign({},e),{key:t})))}),[A,N]);return e.useLayoutEffect((()=>{if(d&&b.current){const{current:e}=b,t=Array.from(e.getElementsByClassName("marquee-item")).slice(0,A.length),n=null==t?void 0:t.length;if(n){const a="left"===l||"right"===l,{sizeSum:i,marginSum:r}=t.reduce(((e,t)=>{let{sizeSum:n,marginSum:i}=e;const{marqueeItemSize:r,marqueeItemMargin:m}=s(a,t);return{sizeSum:n+r,marginSum:i+m}}),{sizeSum:0,marginSum:0}),m=u({totalSize:"number"==typeof h?i+h*n:i+r,containerSize:e[a?"offsetWidth":"offsetHeight"],elementLength:n});w(m)}}}),[d,l,h,A]),e.createElement("div",{ref:b,className:o("marquee-wrapper",{paused:g},m)},e.createElement("div",{className:o("marquee-content",l,{off:p,"space-between":"number"==typeof h}),style:{animationDuration:y,animationDelay:I,animationIterationCount:q,"--space-between":"".concat(h,"px")},onAnimationStart:z,onAnimationIteration:E,onAnimationEnd:M},k))};export{l as default};
