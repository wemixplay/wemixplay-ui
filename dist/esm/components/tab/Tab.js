"use client";
import e,{useRef as t,useMemo as n,useState as r,useCallback as a,useEffect as i}from"react";import{Swiper as l,SwiperSlide as s}from'./../../ext/swiper/swiper-react.js';import{makeCxFunc as c}from"../../utils/forReactUtils.js";import o from"../ripple/Ripple.js";import d from"./Tab.module.scss.js";const v=c(d);var u=c=>{let{className:d="",tabItems:u,activeKey:m,name:b,slider:f,swipeContent:p,disabled:y,rippleOption:h={disabled:!0},tabNavScrollRef:k,destroyInactiveTabPanel:w=!0,onClick:E,handleChange:N}=c;var x;const I=t(null),L=t(null),g=t([]),j=t(),C=t(!1),R=n((()=>{var e;return null!==(e=null==u?void 0:u.filter((e=>!(null==e?void 0:e.isHide))))&&void 0!==e?e:[]}),[u]),[T,z]=r(null!=m?m:null===(x=R[0])||void 0===x?void 0:x.key),O=n((()=>{const e=R.findIndex((e=>e.key===T));return-1===e?0:e}),[T,R]),S=n((()=>{var t,n,r;if(!R.length)return[];if(p){const t=()=>{var e,t;const{swipeDirection:n}=j.current,{key:r,disabled:a}=R[j.current.activeIndex],{key:i}=null!==(e=R[j.current.activeIndex-1])&&void 0!==e?e:R[0],{key:l}=null!==(t=R[j.current.activeIndex+1])&&void 0!==t?t:R[j.current.activeIndex];a?(z("next"===n?l:i),N&&N("next"===n?l:i,b)):(z(r),N&&N(r,b))};return e.createElement(l,{className:v("tab-content-holder"),autoHeight:!0,threshold:1,slidesPerView:1,enabled:!y,onSwiper:e=>{j.current=e},onSlideChange:t},R.map(((t,n)=>e.createElement(s,{key:t.key,className:v("tabs-content","active",{disabled:y||t.disabled}),style:{visibility:t.disabled?"hidden":"visible"}},t.children))))}return w?e.createElement("div",{key:"contents-".concat(null===(t=R[O])||void 0===t?void 0:t.key),className:v("tab-content-holder")},e.createElement("div",{className:v("tabs-content","active",{disabled:y||(null===(n=R[O])||void 0===n?void 0:n.disabled)})},null===(r=R[O])||void 0===r?void 0:r.children)):e.createElement("div",{className:v("tab-content-holder")},R.map(((t,n)=>e.createElement("div",{key:"contents-".concat(t.key),className:v("tabs-content",{active:O===n,disabled:y||t.disabled})},t.children))))}),[O,w,y,N,b,p,R]),W=a((()=>{var e,t;const n=null!==(e=null==k?void 0:k.current)&&void 0!==e?e:L.current,r=null!==(t=g.current.find((e=>e&&e.classList.contains("active"))))&&void 0!==t?t:g.current[0];if(r){const{offsetLeft:e,clientWidth:t}=r,a=e-n.offsetWidth/2+t/2;n.scrollTo({top:0,left:a,behavior:"smooth"})}}),[k]),H=a((()=>{var e;const t=I.current;if(!f||!t)return;const n=null!==(e=g.current.find((e=>e&&e.classList.contains("active"))))&&void 0!==e?e:g.current[0];if(n){const{offsetLeft:e,clientWidth:r}=n;t.style.transform="translateX(".concat(e,"px)"),t.style.width="".concat(r,"px"),C.current?t.style.transition="":(t.style.transition="none",C.current=!0)}else t.style.transform="translateX(0px)",t.style.width="0px"}),[f]),P=a(((e,t)=>{void 0===m&&z(e),N&&N(e,b),E&&E(e,t)}),[m,b,N,E]),X=n((()=>{if("undefined"!=typeof window)return new ResizeObserver((()=>{H()}))}),[H]);return i((()=>{void 0!==m&&m!==T&&z(m)}),[m,T]),i((()=>{H(),W(),j.current&&j.current.slideTo(O,250)}),[O,H,W]),i((()=>{const e=()=>{H(),W()};return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[H,W]),i((()=>{p&&j.current&&(y?j.current.disable():j.current.enable())}),[y,p]),i((()=>{if(X){const e=g.current;return e.forEach((e=>{e&&X.observe(e)})),()=>{e.forEach((e=>{e&&X.unobserve(e)}))}}}),[X]),e.createElement("div",{className:v(d,"tab",{"swipe-content":p})},e.createElement("div",{className:v("tab-nav-wrap")},e.createElement("div",{ref:L,className:v("tab-nav-scroll")},e.createElement("div",{className:v("tab-nav")},R.map(((t,n)=>e.createElement(o,Object.assign({key:t.key},h,{disabled:h.disabled||t.disabled||y}),e.createElement("button",{ref:e=>{g.current[n]=e},key:t.key,role:"tab",className:v("tab-btn",{active:T===t.key}),disabled:y||t.disabled,onClick:e=>P(t.key,e)},t.label)))),f&&e.createElement("span",{ref:I,className:v("slider")})))),S)};export{u as default};
